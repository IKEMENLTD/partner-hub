# 人間判断タスク 実行ガイド

## 1. シードデータ実行

### 目的
テンプレート3種類とエスカレーションルールを本番DBに投入

### 手順

1. **Supabase Dashboard** にログイン
2. **SQL Editor** を開く
3. `database/seeds/001_project_templates.sql` の内容をコピーして実行
4. `database/seeds/002_escalation_rules.sql` の内容をコピーして実行

### 完了条件
- テンプレート3件が表示される
- エスカレーションルール5件が表示される

---

## 2. E2Eテスト実施

### 目的
主要な画面フローが正常に動作することを確認

### テストシナリオ

#### 2.1 ログイン〜ダッシュボード
| # | 操作 | 期待結果 |
|---|------|----------|
| 1 | ログイン画面を開く | ログインフォームが表示される |
| 2 | メール/パスワードを入力してログイン | My Todayダッシュボードに遷移 |
| 3 | 「今日のタスク」セクションを確認 | タスク一覧が表示される |
| 4 | 「今後の期限」セクションを確認 | 今週の期限タスクが表示される |

#### 2.2 案件管理
| # | 操作 | 期待結果 |
|---|------|----------|
| 1 | サイドバー「案件一覧」をクリック | 案件一覧ページに遷移 |
| 2 | 「新規案件」ボタンをクリック | 案件作成フォームが表示される |
| 3 | 必須項目を入力して保存 | 案件が作成され、詳細ページに遷移 |
| 4 | ビュー切り替え（リスト/カンバン/カレンダー） | 各ビューが正常に表示される |

#### 2.3 タスク管理
| # | 操作 | 期待結果 |
|---|------|----------|
| 1 | 案件詳細ページのタスクタブを開く | タスク一覧が表示される |
| 2 | 「タスク追加」ボタンをクリック | タスク作成フォームが表示される |
| 3 | タスクを作成 | タスクが一覧に追加される |
| 4 | タスクのステータスを変更 | ステータスが更新される |
| 5 | タスクに担当者を割り当て | 担当者が設定される |

#### 2.4 パートナー管理
| # | 操作 | 期待結果 |
|---|------|----------|
| 1 | サイドバー「パートナー」をクリック | パートナー一覧ページに遷移 |
| 2 | 「新規パートナー」ボタンをクリック | パートナー登録フォームが表示される |
| 3 | パートナー情報を入力して保存 | パートナーが作成される |
| 4 | パートナー詳細を開く | 詳細情報と関連案件が表示される |

#### 2.5 通知設定
| # | 操作 | 期待結果 |
|---|------|----------|
| 1 | ユーザーメニュー「設定」をクリック | 設定ページに遷移 |
| 2 | 通知設定を変更 | 設定が変更できる |
| 3 | 「保存」ボタンをクリック | 「設定を保存しました」メッセージが表示される |

#### 2.6 テンプレート適用
| # | 操作 | 期待結果 |
|---|------|----------|
| 1 | 新規案件作成画面を開く | テンプレート選択が表示される |
| 2 | テンプレートを選択 | フェーズとタスクが自動入力される |
| 3 | 案件を保存 | テンプレートのタスクが自動作成される |

### 完了条件
- 全シナリオでエラーなく操作完了
- コンソールにエラーログがない

---

## 3. 性能テスト

### 目的
要件の「3秒以内表示」「500ms API応答」を検証

### 手順

#### 3.1 ページ読み込み速度
1. Chrome DevTools を開く（F12）
2. 「Network」タブを選択
3. 「Disable cache」にチェック
4. 各ページを読み込み、「Load」時間を確認

| ページ | 目標 | 実測値 | 結果 |
|--------|------|--------|------|
| My Today | 3秒以内 | _____ms | ○/× |
| 案件一覧 | 3秒以内 | _____ms | ○/× |
| 案件詳細 | 3秒以内 | _____ms | ○/× |
| パートナー一覧 | 3秒以内 | _____ms | ○/× |

#### 3.2 API応答速度
1. Chrome DevTools「Network」タブ
2. 「XHR」フィルターを選択
3. 各操作を行い、APIの「Time」列を確認

| API | 目標 | 実測値 | 結果 |
|-----|------|--------|------|
| GET /projects | 500ms以内 | _____ms | ○/× |
| GET /tasks | 500ms以内 | _____ms | ○/× |
| GET /partners | 500ms以内 | _____ms | ○/× |
| GET /dashboard/my-today | 500ms以内 | _____ms | ○/× |
| POST /projects | 500ms以内 | _____ms | ○/× |
| PATCH /tasks/:id | 500ms以内 | _____ms | ○/× |

#### 3.3 Lighthouse監査（オプション）
1. Chrome DevTools「Lighthouse」タブ
2. 「Performance」を選択して実行
3. スコアを確認（目標: 70以上）

### 完了条件
- 全ページ3秒以内に読み込み完了
- 全API 500ms以内に応答
- Lighthouseスコア 70以上（推奨）

---

## 4. LINE/SMS連携（オプション）

### 判断ポイント
- 外部パートナーへの通知でLINE/SMSが必要か？
- メール + Slackで十分か？

### 実装する場合の手順

#### LINE連携
1. LINE Developers でチャネル作成
2. Messaging API を有効化
3. チャネルアクセストークンを取得
4. 環境変数に設定:
   ```
   LINE_CHANNEL_ACCESS_TOKEN=xxxxx
   LINE_CHANNEL_SECRET=xxxxx
   ```
5. `notification/services/line.service.ts` を実装

#### SMS連携（Twilio）
1. Twilioアカウント作成
2. 電話番号を取得
3. 環境変数に設定:
   ```
   TWILIO_ACCOUNT_SID=xxxxx
   TWILIO_AUTH_TOKEN=xxxxx
   TWILIO_PHONE_NUMBER=+81xxxxx
   ```
4. `notification/services/sms.service.ts` を実装

### 判断結果
- [ ] LINE連携を実装する
- [ ] SMS連携を実装する
- [ ] 今回は見送り（メール + Slackで運用）

---

## 5. 最終動作確認チェックリスト

### 認証
- [ ] ログインできる
- [ ] ログアウトできる
- [ ] パスワードリセットメールが届く

### 案件管理
- [ ] 案件を作成できる
- [ ] 案件を編集できる
- [ ] 案件を削除できる（または非アクティブ化）
- [ ] テンプレートから案件を作成できる
- [ ] ステータス変更ができる

### タスク管理
- [ ] タスクを作成できる
- [ ] タスクを編集できる
- [ ] タスクのステータスを変更できる
- [ ] 担当者を割り当てできる
- [ ] サブタスクを作成できる

### パートナー管理
- [ ] パートナーを登録できる
- [ ] パートナーを編集できる
- [ ] パートナーを案件に紐付けできる
- [ ] Tier構造（階層）を設定できる

### ダッシュボード
- [ ] My Todayが正常に表示される
- [ ] 今日のタスクが表示される
- [ ] 今後の期限が表示される
- [ ] クイック統計が表示される

### 通知
- [ ] 通知設定を変更できる
- [ ] 設定が保存される

### その他
- [ ] レスポンシブ表示（モバイル）
- [ ] ダークモード切り替え（対応している場合）

---

## 完了報告

全タスク完了後、以下を確認:

1. **シードデータ**: テンプレート3件、エスカレーションルール5件が存在
2. **E2Eテスト**: 全シナリオ合格
3. **性能テスト**: 要件達成
4. **最終確認**: 全チェック項目合格

**リリース準備完了** ✅
