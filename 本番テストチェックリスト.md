# 本番環境テストチェックリスト

## 前提
- ADMINアカウントでテスト（全機能アクセス可能）
- テスト用パートナー1社を事前作成
- MEMBERアカウントも用意（権限テスト用）

---

## 1. 認証 [必須]

- [ ] ログインページ表示 → メール＋パスワード入力 → ダッシュボードへ遷移
- [ ] 誤ったパスワードで日本語エラーメッセージ表示
- [ ] 「パスワードを忘れた」→ メール送信 → リセットメール受信確認
- [ ] リセットメールのリンクからパスワード変更ページ → 新パスワード設定 → ログイン確認
- [ ] ログアウト → 保護ページにアクセス不可
- [ ] ログアウト後にブラウザバックで保護ページに戻れないことを確認

---

## 2. My Today ダッシュボード [必須]

- [ ] `/today` に今日のタスク・今後の期限・アラートが表示
- [ ] タスクのステータスをワンクリックで変更可能
- [ ] プロジェクト名クリック → 詳細ページへ遷移
- [ ] タスクがない場合の空状態表示

---

## 3. プロジェクト管理 [必須]

### 一覧
- [ ] リスト/カンバン/カレンダーのビュー切り替え
- [ ] ステータス・優先度でフィルタリング
- [ ] 検索（2文字以上）
- [ ] ソート切り替え（作成日/期限/名前）

### 新規作成
- [ ] テンプレート選択 → フェーズ＋タスクのプレビュー表示
- [ ] 案件名・説明・開始日・予算を入力
- [ ] パートナーを選択 + Tier指定（Tier 1/2/3）→「追加」
- [ ] 2社以上追加して各Tierが表示されることを確認
- [ ] カスタムフィールド追加（テキスト＋数値＋選択肢）
- [ ] カスタムフィールドテンプレートから選択して追加
- [ ] 「作成」→ 詳細ページに遷移

### 作成後の確認
- [ ] テンプレートのタスクが自動生成されている
- [ ] 関係者ツリーにパートナーがTier付きで表示される
- [ ] 関係者ツリー「全て展開」「全て折りたたむ」が動作する
- [ ] カスタムフィールドの値が保存されている
- [ ] ヘルススコアが表示される

### 編集
- [ ] パートナー追加/削除 → 保存 → ツリーに反映
- [ ] 関係者のTier変更 → 保存 → ツリーに反映
- [ ] カスタムフィールドのバリデーション（必須・最小/最大値）
- [ ] プロジェクト削除 → 確認ダイアログ → ソフトデリート

### 関係者ツリー操作
- [ ] 関係者「追加」ボタン → モーダル表示 → パートナー選択 + Tier指定 → 追加成功
- [ ] 関係者の編集（Tier変更・役割記述）
- [ ] 関係者の削除

---

## 4. タスク管理 [必須]

- [ ] プロジェクト詳細からタスク作成
- [ ] タイトル・説明・期限・優先度・担当者を設定
- [ ] パートナーをタスクに割り当て
- [ ] サブタスク追加 → 完了チェック
- [ ] ステータス変更（未着手→進行中→完了）
- [ ] 進捗率スライダー操作
- [ ] タスク編集 → 保存
- [ ] タスク削除 → 確認ダイアログ → 削除完了

---

## 5. パートナー管理 [必須]

### CRUD
- [ ] 新規パートナー作成（会社名・担当者名・メール）
- [ ] パートナー一覧で検索・フィルタリング
- [ ] パートナー詳細表示
- [ ] パートナー編集・保存
- [ ] パートナーステータス変更（active/inactive/suspended）
- [ ] パートナー削除（ソフトデリート）

### 招待
- [ ] パートナー詳細 →「招待を送る」→ メール送信確認
- [ ] 招待メールのリンクから受諾ページ表示
- [ ] 72時間期限切れトークンでアクセス → エラー表示

### 連絡先設定
- [ ] 「連絡先設定リンク送信」→ メール送信確認
- [ ] リンクから連絡先入力フォーム表示 → 保存
- [ ] 7日間期限切れトークンでアクセス → エラー表示

### 評価
- [ ] 自動評価スコア（タスク完了率・期限遵守率）表示
- [ ] 手動評価入力（品質/コミュニケーション/レスポンス速度/信頼性）
- [ ] 評価履歴の表示

### レポートトークン管理
- [ ] パートナー詳細からレポートトークン発行
- [ ] トークン再生成
- [ ] トークン無効化

---

## 6. パートナーポータル [必須]

### レポート提出（トークンURL）
- [ ] `/partner/:token` にアクセス → ログイン不要で表示
- [ ] 担当プロジェクト一覧が表示される
- [ ] レポート種別選択 → 内容入力 → 送信
- [ ] 送信成功メッセージ表示
- [ ] レポート履歴が表示される

### 進捗レポート（3ステップ）
- [ ] `/progress-report/:token` にアクセス
- [ ] Step1: 進捗状況選択（順調/やや遅れ/問題あり）
- [ ] Step2: コメント入力
- [ ] Step3: 確認 → 送信
- [ ] 送信完了ページ表示

### 連絡先設定（トークンURL）
- [ ] `/partner-setup/:token` にアクセス → ログイン不要で表示
- [ ] 連絡先情報入力 → 保存

### 無効トークン
- [ ] 期限切れ/無効化済みトークンでアクセス → エラー表示

---

## 7. リマインダー

- [ ] `/reminders` にリマインダー一覧表示
- [ ] 未読/既読フィルタ切り替え
- [ ] タイプ別フィルタ（タスク期限/遅延/プロジェクト期限/停滞）
- [ ] 「既読にする」→ 未読バッジが減る
- [ ] 「すべて既読」ボタンが動作する

---

## 8. エスカレーション設定 [ADMIN]

### ルール
- [ ] `/admin/escalations` にルール一覧表示
- [ ] 「ルール追加」→ 名前・トリガー条件（期限超過N日/進捗N%未満）・アクション設定
- [ ] ルール作成 → 一覧に表示
- [ ] 有効/無効トグル切り替え
- [ ] ルール編集 → 保存
- [ ] ルール削除 → 確認ダイアログ → 削除

### 実行履歴
- [ ] 「実行履歴」タブ → ログ一覧表示
- [ ] ステータス（実行済み/失敗）・対象タスク・ルール名が表示

---

## 9. マネージャーダッシュボード [ADMIN]

- [ ] `/manager` にアクセス
- [ ] 危険案件（ヘルススコア低下）一覧
- [ ] スタッフ稼働状況（担当タスク数・完了率）
- [ ] 今後のマイルストーン（プロジェクト期限）
- [ ] CSVエクスポート → ダウンロード確認

---

## 10. 自動レポート [ADMIN]

- [ ] `/reports` にレポート設定一覧表示
- [ ] 新規レポート設定作成（名前・タイプ・頻度・送信先）
- [ ] 「今すぐ生成」→ レポート生成
- [ ] CSV ダウンロード確認
- [ ] 生成履歴の表示
- [ ] レポート設定の編集・削除

---

## 11. パートナーレポート

- [ ] `/partner-reports` にレポート一覧表示
- [ ] 未読/既読フィルタ
- [ ] レポートクリック → 詳細表示 → 既読マーク
- [ ] 未読バッジ更新
- [ ] 一括既読ボタン

---

## 12. ファイル管理

- [ ] プロジェクト詳細「ファイル」タブ
- [ ] ファイルアップロード（PDF, 画像等、10MB以下）
- [ ] アップロード成功 → 一覧に表示
- [ ] ファイルダウンロード
- [ ] ファイル削除
- [ ] 10MB超ファイル → エラーメッセージ
- [ ] 許可されない拡張子 → エラーメッセージ

---

## 13. 検索

- [ ] ヘッダー検索ボックスに2文字以上入力
- [ ] プロジェクト・パートナー・タスクが横断検索される
- [ ] 検索結果クリック → 詳細ページへ遷移
- [ ] 1文字入力では検索が発動しないことを確認
- [ ] 300msデバウンスが効いていることを確認（連打で大量リクエストが飛ばない）

---

## 14. 通知

### アプリ内通知
- [ ] ヘッダーのベルアイコン → 通知ドロップダウン
- [ ] 未読バッジ（数字）表示
- [ ] 通知クリック → 既読 + 関連ページへ遷移
- [ ] `/notifications` で通知一覧表示
- [ ] 「すべて既読」ボタン

### リアルタイム通知（WebSocket）
- [ ] ページを開いた状態で別タブからアクション → 通知がリアルタイムで届く
- [ ] 未読バッジがリアルタイムで更新される

---

## 15. 設定

### プロフィール
- [ ] `/profile` でプロフィール編集（氏名等）
- [ ] アバター設定

### 通知設定
- [ ] `/settings` で通知設定（ダイジェスト時間・各種ON/OFF）

### 組織設定 [ADMIN]
- [ ] `/admin/settings` にアクセス
- [ ] Slack Webhook URL設定・保存
- [ ] LINE連携設定
- [ ] SMS/Twilio連携設定

---

## 16. ユーザー管理 [ADMIN]

- [ ] ユーザー一覧表示
- [ ] ユーザー詳細表示
- [ ] ユーザーロール変更（ADMIN/MANAGER/MEMBER）
- [ ] ユーザー無効化 → ログイン不可になることを確認
- [ ] ユーザー有効化 → ログイン可能に復帰

---

## 17. カスタムフィールドテンプレート [ADMIN]

- [ ] テンプレート一覧表示
- [ ] 新規テンプレート作成（名前・フィールドタイプ・バリデーション設定）
- [ ] テンプレートをプロジェクト作成時に選択して利用
- [ ] テンプレート使用回数の表示
- [ ] テンプレート無効化
- [ ] テンプレート削除

---

## 18. 監査ログ [ADMIN]

- [ ] 監査ログ一覧表示
- [ ] エンティティ別フィルタ（プロジェクト/タスク/パートナー等）
- [ ] ユーザー別フィルタ
- [ ] 日付範囲指定フィルタ
- [ ] アクション別フィルタ（作成/更新/削除）
- [ ] 最近のアクティビティ表示

---

## 19. ダッシュボードCSVエクスポート

- [ ] ダッシュボードからCSVエクスポートボタン表示
- [ ] 週次レポート生成 → CSVダウンロード
- [ ] 月次レポート生成 → CSVダウンロード
- [ ] カスタム期間指定 → CSVダウンロード

---

## 20. UI/レスポンシブ

- [ ] サイドバー折りたたみ/展開（デスクトップ）
- [ ] ハンバーガーメニュー（モバイル幅）
- [ ] ダークモード切り替え → リロード後も維持
- [ ] ADMIN以外でログイン → ADMIN限定メニュー非表示
- [ ] ローディングスピナーが適切に表示される
- [ ] 空データ時の表示が適切（「データがありません」等）

---

## 21. エラーハンドリング

- [ ] 存在しないURL → `/today` にリダイレクト
- [ ] MEMBER権限で `/admin/escalations` にアクセス → アクセス拒否
- [ ] MEMBER権限で `/admin/settings` にアクセス → アクセス拒否
- [ ] フォーム必須項目を空で送信 → 日本語エラーメッセージ
- [ ] APIエラー時にErrorBoundaryが動作（本番では詳細非表示）
- [ ] ネットワークエラー時に適切なエラーメッセージ

---

## 22. Cronジョブ・自動処理（運用確認）

- [ ] ヘルススコアが日次で再計算されている（midnight）
- [ ] リマインダーが自動生成されている（毎分）
- [ ] エスカレーションが自動実行されている（毎時）
- [ ] ダイジェストメールが7AMに送信される

---

## テスト結果

| 実施日 | 実施者 | 結果 | 備考 |
|--------|--------|------|------|
|        |        |      |      |
